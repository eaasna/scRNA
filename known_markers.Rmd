---
title: "Known markers for cell-type identification"
author: "Evelin Aasna"
date: "7/15/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(Seurat)
```

```{r}
load(file = "/icgc/dkfzlsdf/analysis/B210/Evelin/seurat_objects/joined.RData")
```

# Finding cluster biomarkers i.e representative genes

Which genes (i.e features) separate cluster 1 from all other clusters? Only searching for positive markers that are expressed in > 25% of cells in cluster 1. 
```{r}
FindMarkers(seu, ident.1 = 1, min.pct=0.25, only.pos = TRUE)[1:10,]
```

Which genes separate cluster 0 from cluster 3?
```{r}
FindMarkers(seu, ident.1 = 0, ident.2 = 3, min.pct=0.25, only.pos = TRUE)[1:10,]
```


# Known markers from cell atlas of human uterus
High levels of gene expression
Endometrial epithelial: KRT8, KRT18, EPCAM and CLDN3
Endometrial stromal: MME, FN1, COL3A1, HOXA10
Endothelial: CD34, VWF, CLDN5, SOX18
SMA+(smooth muscle and myofibrolblasts): ACTA2, MYH11, MYL6, MYL9
Endometrial immune: PTPRC, CD68, CD163 and CD96

```{r}
epi_ref=c("KRT8", "KRT18", "EPCAM", "CLDN3")
stro_ref = c("MME", "FN1", "COL3A1", "HOXA10")
the_ref = c("CD34", "VWF", "CLDN5", "SOX18")
muscl_ref = c("ACTA2", "MYH11", "MYL6", "MYL9")
immu_ref = c("PTPRC","CD68", "CD136", "CD96")
```

# Known markers from molecular and cellular cartography
Decidual glandular epithelial: EPCAM, PAEP
Endothelial: CD34, CD31 antigen (PECAM1)
Heterogeneous population of fibroblasts: express matrix protein genes (e.g. PCOLCE, COL6A2) and is negative for PAEP, CD45, and CD31

```{r}
c("EPCAM", "PAEP")
c("CD34", "CD31")
c("PCOLCE", "COL6A2")
```

Ideas for violin plotting??
1. visualize cluster marker genes
2. visualize highly differentially expressed genes
3. visualize known markers for specific cell types
```{r}
VlnPlot(seu, features = c("EPCAM", "PAEP"), 
    pt.size = 0.2, ncol = 2)
```


Visualize on embedding 
```{r}
FeaturePlot(seu, reduction = "tsne", features = c("EPCAM", "PAEP"), pt.size = 0.2, ncol = 2)
```

